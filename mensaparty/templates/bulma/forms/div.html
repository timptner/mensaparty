{{ errors }}

{% if errors and not fields %}
    <div>
        {% for field in hidden_fields %}
            {{ field }}
        {% endfor %}
    </div>
{% endif %}

{% for field, errors in fields %}
    <div class="field">
        {% if field.use_fieldset %}
            <fieldset>
            {% if field.label %}{{ field.legend_tag }}{% endif %}
        {% else %}
            {% if field.label %}{{ field.label_tag }}{% endif %}
        {% endif %}

        <div class="control">
            {{ field }}
        </div>

        {% if field.help_text %}
            <p class="help">{{ field.help_text|safe }}</p>
        {% endif %}

        {{ errors }}

        {% if field.use_fieldset %}
            </fieldset>
        {% endif %}

        {% if forloop.last %}
            {% for field in hidden_fields %}
                {{ field }}
            {% endfor %}
        {% endif %}
    </div>
{% endfor %}

{% if not fields and not errors %}
    {% for field in hidden_fields %}
        {{ field }}
    {% endfor %}
{% endif %}
